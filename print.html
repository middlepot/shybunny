<html>

<!--

　　　          ___   .--.
　　　    .--.-"   "-' .- |
　　　   / .-,`          .'   
　　　   \   `           \ 　　　　　　。・゜ 　♡   。　　・　゜ 　　　♡  
　　　    '.            ・ \　　　　　　　　　　　　　　　　　　　　　　　　♡　　　　♡ ゜・。。♡  
　　　      |  ・     ᴥ    。|　　　　・゜♡ ゜・。　　. * ・ ♡ °  . 。
　　　      \ 。            /.____　　　　　　　　　　　　　　　　　　♡.  
　　　     /`-.          ,'.'    `\　　　　　　　　　　　　　　　　　　。・゜　　　 ♡ ・ 。　　。・゜ ♡  
　　　  __/   \`-.____.-' `\      /　　　　　♡　。・゜      
　　　  | `---`'-'._/-`     \----'    _ 　　　　　　　　　　　♡　　　.　　　.♡ 
　　　  |,-'`  /             |    _.-' `\　　　　. * ・        
　　　 .'     /              |--'`     / |　　　　　　　　　　 ♡
　　　/      /\              `         | |
　　　|   .\/  \      .--. __          \ |　　　　　　　　　　　*.。middlepot.com 
　　　 '-'      '._       /  `\         /　　　　　　　　　　　　　　　　　　　　　　　ଘ(*´ ˘ `*)ഒ 。.*
　　　             `\    '     |------'`
　　　               \  |      |
　　　                \        /
 　　　                '._  _.'

-->

<title>shy bunny store ꒱</title>

<head>
<link rel="shortcut icon" href="./img/favicon.png">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="title" content="ꔫ">
<meta name="description" content="shy bunny store ꒱">
<meta name="theme-color" content="#f7e9ed">
<meta property="og:url" content="https://shybunny.store">
<meta property="og:title" content="ꔫ">
<meta property="og:description" content="shy bunny store ꒱">
<meta property="og:image" content="https://middlepot.com/img/delicate.jpg">
<meta property="og:image:type" content="image/jpeg">
<meta property="og:type" content="website">
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://shybunny.store">
<meta property="twitter:title" content="ꔫ">
<meta property="twitter:description" content="shy bunny store ꒱">
<meta property="twitter:image" content="https://middlepot.com/img/delicate.jpg">


<meta name="google-site-verification" content="oeNF1rwRb131oa5qR8WVVfiQTt36bZAq1i0EVXafmnE" />

<style>
body{ 
  cursor: url(./img/cursor.png), progress;}
a:hover {cursor: url(./img/cursorhover.png), progress;}
 ::selection {text-shadow: 0 0 2px #cec1bb;color:#cec1bb}
 ::-moz-selection {text-shadow: 0 0 2px #cec1bb;color:#cec1bb}
</style>

<style type="text/css">
::-webkit-scrollbar {
width: 5px;
height: 4px;
background: transparent;
}
::-webkit-scrollbar-thumb {
background-color: #fcf7f7;
-webkit-border-radius: 3ex;
border-radius: 3ex;
border: 1px dotted #baaeab;
}
</style>
<style>
html {
    -webkit-text-size-adjust: 100%;
    text-size-adjust: 100%;
}

@media screen and (max-width: 1000px) and (orientation: portrait){
#everything { position: absolute; zoom: 255%;
	left:-350px; top:70px;}
}
@media screen and (min-width: 1700px) and (orientation: landscape){
#everything { position: absolute; zoom: 120%;
	left:150px;
	top:40px; }
}
@media screen and (min-width: 2000px) and (orientation: landscape){
#everything { position: absolute; zoom: 100%;
	left:-150px; top:10px;}
}
@media screen and (min-width: 3000px) and (orientation: landscape){
#everything { position: absolute; zoom: 240%;
	left:150px;
	top:40px; }
}
@media screen and (max-width: 1000px) and (orientation: landscape){
#everything { position: absolute; zoom: 85%; left:-100px; top:0px;}
}
</style>
<style>
.row {display: flex;}
.column {float: left; display: block;}
.left {width: 30%;}
.middle {width: 40%;}
.right {width: 20%;}
.row:after {content: ""; display: table; clear: both;}
.block{display: block; margin-top: 10px; margin-bottom: 5px;}
label{margin-right: 10px;}
#base{width: 1150px; left: 5%;}
</style>

<script src="https://code.jquery.com/jquery-3.6.0.slim.min.js" integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=" crossorigin="anonymous"></script>
<script src="/js/util.js"></script>

</head>

<body oncontextmenu="return false" ondragstart="return false" style="background-image:url(./img/bg.png); background-repeat: repeat; font-family: Calibri; font-size: 11px; letter-spacing:1px; color:#998585;">
<div id="everything">

	<div id="login">
		<div style="position: fixed; width: 100%; height: 100%; top: 0; left: 0; background: rgba(255, 255, 255, 0.3); z-index: 999990;">
			<div style="text-align:center; width: 500px;">
				<input type="text" id="user" placeholder="type your email" maxlength="30" style="position: absolute; top: 320px; left: 640px; height:31px; width:140px; border: none; border-width: 0px !important; background-color: transparent; background-image:url(./img/textbox.png); outline:none; padding-left:5px; padding-right:5px; cursor: url(./img/cursorwrite.png), progress; font-family: Verdana; font-size: 10px; letter-spacing:1px; color:#b8a0a3; text-align:center;"/><br>
				<input type="password" id="password" placeholder="type your password" maxlength="32" style="position: absolute; top: 360px; left: 640px; height:31px; width:140px; border: none; border-width: 0px !important; background-color: transparent; background-image:url(./img/textbox.png); outline:none; padding-left:5px; padding-right:5px; cursor: url(./img/cursorwrite.png), progress; font-family: Verdana; font-size: 10px; letter-spacing:1px; color:#b8a0a3; text-align:center;"/><br>
				<p style="display: none; position: absolute; top: 385px; left: 640px;" id="input_credentials_error_invalid">wrong user or password !</p>
				<p style="display: none; position: absolute; top: 385px; left: 640px;" id="input_credentials_error_forbidden">you're not allowed to do this.</p>
				<p style="display: none; position: absolute; top: 385px; left: 645px;" id="input_error_invalid">something went wrong !</p>
				<br>
				<input style="position: absolute; top: 410px; left: 680px; width:50px; height:31px; border: none; border-width: 0px !important; background-color: transparent; background-image:url(./img/okbutton.png); cursor: url(./img/cursorhover.png), progress; outline: none;" type="button" onclick="login();"/>
			</div>
		</div>
	</div>

	<div class="row" style="display: none;" id="content">
		<div class="column left" style="overflow: scroll; height: 450px;">
			<div class="block">
				<label for="screenshots">screenshots</label>
				<select class="form-field" name="screenshots" onchange="updateScreenshot();" id="screenshots">
				</select>
				<button class="btn" onclick="approveScreenshot();" style="margin-top: 10px;">approve screenshot</button>
				<button class="btn" onclick="rejectScreenshot();" style="margin-top: 10px;">reject screenshot</button>
			</div>
		</div>
		<div class="column middle">
			<img style="height: 500px; width: auto;" id="screenshotDisplay">
		</div>
	</div>

<script>
	var api_path = 'https://api.middlepot.com/v1';
	var poofties_api_path = 'https://api.poofties.club/v1/shybunny';
	var loginEmail;
	var loginPass;
	async function login(){
		showLoadingOverlay();
		try{
			document.getElementById('input_credentials_error_invalid').style.display = 'none';
			document.getElementById('input_error_invalid').style.display = 'none';
			document.getElementById('input_credentials_error_forbidden').style.display = 'none';

			var user = document.getElementById('user').value;
			var password = document.getElementById('password').value;
			if(!validateEmail(user) || !password || password.length < 8 || password.length > 32){
				document.getElementById('input_credentials_error_invalid').style.display = 'block';
				return;
			}

			var passB64 = btoa(password);
			var req = await fetch(poofties_api_path+'/ribbons/public-marketing/screenshot?email='+user+'&password='+passB64, {
				method: 'GET',
				headers: {
					'content-type': 'application/x-www-form-urlencoded'
				}
			});
			if(req.status === 401){
				document.getElementById('input_credentials_error_invalid').style.display = 'block';
			}
			else if(req.status === 403){
				document.getElementById('input_credentials_error_forbidden').style.display = 'block';
			}
			else if(req.status !== 200){
				document.getElementById('input_error_invalid').style.display = 'block';
			}
			else{
				//all ok
				loginEmail = user;
				loginPass = passB64;
				var body = await req.json();
				//populate select element
				if(body.screenshots){
					var screenshots = body.screenshots;
					if(Array.isArray(screenshots) && screenshots.length > 0){
						screenshots.forEach(shot =>{
							var opt = document.createElement('option');
							opt.setAttribute('value', shot.filename);
							opt.setAttribute('imagepath', shot.path);
							opt.setAttribute('user_id', shot.user_id);
							opt.setAttribute('id', shot.user_id);
							opt.innerHTML = shot.user_id;
							document.getElementById('screenshots').appendChild(opt);
						});
						updateScreenshot();
					}
				}
				document.getElementById('login').style.display = 'none';
				document.getElementById('content').style.display = 'block';
			}
		}
		catch(err){
			document.getElementById('input_error_invalid').style.display = 'block';
			console.log(err);
		}
		finally{
			hideLoadingOverlay();
		}
	}

	function updateScreenshot(){
		var shots = document.getElementById('screenshots');
		if(shots.options.length > 0){
			var selected = shots.options[shots.selectedIndex];
			if(selected){
				var imagepath = selected.getAttribute('imagepath');
				document.getElementById('screenshotDisplay').src = imagepath;
				document.getElementById('screenshotDisplay').style.display = 'block';
			}
			return;
		}
		document.getElementById('screenshotDisplay').style.display = 'none';
	}
	updateScreenshot(); //first load screenshots

	function removeScreenshot(idx){
		var screenshots = document.getElementById('screenshots');
		screenshots.removeChild(screenshots.options[idx]);
		updateScreenshot();
	}

	async function approveScreenshot(){
		var screenshotsEl = document.getElementById('screenshots');
		var selected = screenshotsEl.value;
		if(!selected){
			return;
		}
		var opt = screenshotsEl.options[screenshotsEl.selectedIndex];
		if(confirm('Are you sure you want to approve this screenshot?')){
			try{
				showLoadingOverlay();
				var req = await fetch(poofties_api_path+'/ribbons/public-marketing/screenshot/approve', {
					method: 'POST',
					headers:{
						'Content-Type': 'application/json'
					},
					body: JSON.stringify({
						screenshot: selected,
						email: loginEmail,
						password: loginPass
					})
				});
				if(req.status === 200){
					removeScreenshot(screenshotsEl.selectedIndex);
				}
				else{
					throw new Error(req.status);
				}
			}
			catch(err){
				console.log(err);
				alert(err);
				location.reload();
			}
			finally{
				hideLoadingOverlay();
			}
		}
	}

	async function rejectScreenshot(){
		var screenshotsEl = document.getElementById('screenshots');
		var selected = screenshotsEl.value;
		if(!selected){
			return;
		}
		if(confirm('Are you sure you want to reject this screenshot?')){
			try{
				showLoadingOverlay();
				var req = await fetch(poofties_api_path+'/ribbons/public-marketing/screenshot/reject', {
					method: 'POST',
					headers:{
						'Content-Type': 'application/json'
					},
					body: JSON.stringify({
						screenshot: selected,
						email: loginEmail,
						password: loginPass
					})
				});
				if(req.status === 200){
					removeScreenshot(screenshotsEl.selectedIndex);
				}
				else{
					throw new Error(req.status);
				}
			}
			catch(err){
				console.log(err);
				alert(err);
				location.reload();
			}
			finally{
				hideLoadingOverlay();
			}
		}
	}
</script>

</div>
</body>

<!--

　　　          ___   .--.
　　　    .--.-"   "-' .- |
　　　   / .-,`          .'   
　　　   \   `           \ 　　　　　　。・゜ 　♡   。　　・　゜ 　　　♡  
　　　    '.            ・ \　　　　　　　　　　　　　　　　　　　　　　　　♡　　　　♡ ゜・。。♡  
　　　      |  ・     ᴥ    。|　　　　・゜♡ ゜・。　　. * ・ ♡ °  . 。
　　　      \ 。            /.____　　　　　　　　　　　　　　　　　　♡.  
　　　     /`-.          ,'.'    `\　　　　　　　　　　　　　　　　　　。・゜　　　 ♡ ・ 。　　。・゜ ♡  
　　　  __/   \`-.____.-' `\      /　　　　　♡　。・゜      
　　　  | `---`'-'._/-`     \----'    _ 　　　　　　　　　　　♡　　　.　　　.♡ 
　　　  |,-'`  /             |    _.-' `\　　　　. * ・        
　　　 .'     /              |--'`     / |　　　　　　　　　　 ♡
　　　/      /\              `         | |
　　　|   .\/  \      .--. __          \ |　　　　　　　　　　　*.。middlepot.com 
　　　 '-'      '._       /  `\         /　　　　　　　　　　　　　　　　　　　　　　　ଘ(*´ ˘ `*)ഒ 。.*
　　　             `\    '     |------'`
　　　               \  |      |
　　　                \        /
 　　　                '._  _.'

-->

</html>